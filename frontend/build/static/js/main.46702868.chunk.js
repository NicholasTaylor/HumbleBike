(this["webpackJsonphumble-bike-v2"]=this["webpackJsonphumble-bike-v2"]||[]).push([[0],{23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n(0),i=n.n(a),c=n(5),r=n.n(c),o=(n(23),n(24),n(12)),l=n(13),u=n(17),h=n(16);var d=function(){return Object(s.jsx)("header",{children:Object(s.jsxs)("div",{id:"title",children:[Object(s.jsxs)("h1",{children:[Object(s.jsx)("span",{className:"noBold",children:"Humble"}),"Bike",Object(s.jsx)("sup",{children:"BETA"})]}),Object(s.jsx)("h2",{children:"Life should be simpler. So should finding a CitiBike."})]})})},f="https://use.typekit.net/gle3drj.css";var j=function(){return Object(s.jsx)("link",{rel:"stylesheet",href:f})},b=(n(25),n(6)),p="DATA_LOAD_SUCCESS",O="REQUEST_DATA_LOAD",v="SEARCH_STATIONS",g="FILTER_ELEC";var m=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.requestDataLoad(),setInterval(this.props.requestDataLoad,1e4)}},{key:"componentWillUnmount",value:function(){clearInterval(this.props.requestDataLoad,1e4)}},{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{children:[Object(s.jsx)(j,{}),Object(s.jsx)("div",{id:"container",children:Object(s.jsxs)("div",{id:"content",className:this.props.search+" "+this.props.filterElec,children:[Object(s.jsx)(d,{}),Object(s.jsxs)("div",{id:"updated",children:[Object(s.jsxs)("h2",{children:["Last updated: ",this.props.updated]}),Object(s.jsxs)("span",{className:"search btn",onClick:this.props.requestDataLoad,children:["Refresh",Object(s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"btn-icon",children:Object(s.jsx)("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})})]}),Object(s.jsxs)("span",{className:"search",children:["Search: ",Object(s.jsx)("input",{type:"text",label:"search",value:this.props.searchQuery,onChange:function(t){return e.props.searchStations(t)}})]}),Object(s.jsxs)("span",{className:"search",children:["Electric Only? ",Object(s.jsx)("input",{type:"checkbox",label:"Electric Only?",onChange:function(t){return e.props.filterElecToggle(t)},checked:"filterElecOn"===this.props.filterElec?"checked":""})]})]}),this.props.stations.map((function(e){return Object(s.jsx)("section",{className:(e.isVisible?"stationOn":"stationOff")+" "+(e.electric>0?"elecOn":"elecOff"),children:Object(s.jsxs)("div",{className:"container-station",children:[Object(s.jsxs)("h3",{className:"station-name",children:[e.name,e.dist]}),Object(s.jsxs)("div",{className:"infoSection classic-bikes",children:[Object(s.jsx)("h4",{className:"bikes-remaining",children:e.classic}),Object(s.jsx)("h5",{className:"descriptor",children:"Classic"})]}),Object(s.jsxs)("div",{className:"infoSection ebikes",children:[Object(s.jsx)("h4",{className:"ebikes-remaining",children:e.electric}),Object(s.jsx)("h5",{className:"descriptor",children:"Electric"})]}),Object(s.jsxs)("div",{className:"infoSection docks",children:[Object(s.jsx)("h4",{className:"docks-remaining",children:e.docks}),Object(s.jsx)("h5",{className:"descriptor",children:"Docks"})]})]})},e.station_id)}))]})})]})}}]),n}(i.a.Component);var x=Object(b.b)((function(e){return{stations:e.stations,updated:e.updated,hasLocation:e.hasLocation,searchQuery:e.searchQuery,search:e.search,filterElec:e.filterElec}}),{requestDataLoad:function(){return function(e){return e({type:O})}},searchStations:function(e){return function(t){return t({type:v,payload:{searchQuery:e.target.value}})}},filterElecToggle:function(e){return function(t){return t({type:g,payload:{searchQuery:e.target.value}})}}})(m),y=n(4),k=n(10),E={stations:[],updated:"",hasLocation:!1,searchQuery:"",search:"searchOff",filterElec:"filterElecOff"};var _=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0,n=function(e,t,n,s){var a=function(e){return e*Math.PI/180},i=a(e),c=a(n),r=a(e-n),o=a(t-s),l=Math.sin(r/2)*Math.sin(r/2)+Math.sin(o/2)*Math.sin(o/2)*Math.cos(i)*Math.cos(c),u=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l));return Math.round(6371*u*.621371*100)/100};if(t.type===p){for(var s=[],a=0;a<e.stations.length;a++){var i=e.stations[a];s.push(i.station_id)}var c=[],r=t.payload.location,o=!!r.isLocation;for(var l in t.payload.stations.data.stations){var u=t.payload.stations.data.stations[l];for(var h in t.payload.info.data.stations){var d=t.payload.info.data.stations[h];if(u.station_id===d.station_id){var f=s.includes(u.station_id)?Object(k.a)({},e.stations[s.indexOf(u.station_id)]):{};f.station_id=u.station_id,f.classic=u.num_bikes_available,f.docks=u.num_docks_available,f.electric=u.num_ebikes_available,f.name=d.name,o&&(f.dist=" ("+n(r.lat,r.lon,d.lat,d.lon)+" mi.)"),c.push(f);break}}}var j=o?c.sort((function(e,t){return e.dist>t.dist?1:-1})):c.sort((function(e,t){return e.name>t.name?1:-1})),b=new Date,O=function(e){return e>=10?e:"0"+e};O(b.getMonth()+1),O(b.getDate()),b.getYear(),O(b.getHours()),O(b.getMinutes()),O(b.getSeconds());return Object.assign({},e,{stations:j,updated:O(b.getMonth()+1)+"/"+O(b.getDate())+"/"+(b.getYear()+1900)+" "+O(b.getHours())+":"+O(b.getMinutes())+":"+O(b.getSeconds()),hasLocation:o,search:e.search})}if(t.type===v){var m=t.payload.searchQuery,x=Object.assign([],e.stations);if(m.length>0){for(var y=0;y<x.length;y++){var _=x[y];_.name.toLowerCase().includes(m.toLowerCase())?_.isVisible=!0:_.isVisible=!1}return Object.assign({},e,{searchQuery:m,stations:x,search:"searchOn"})}for(var L=0;L<x.length;L++){var N=x[L];N.isVisible=!1}return Object.assign({},e,{searchQuery:m,stations:x,search:"searchOff"})}if(t.type===g){var M=Object(k.a)({},e);return M.filterElec="filterElecOff"===e.filterElec?"filterElecOn":"filterElecOff",Object.assign({},M)}return e},L=n(15),N=function(e){return fetch("https://gbfs.citibikenyc.com/gbfs/en/station_status.json").then((function(e){return e.json()})).then((function(t){return Object.assign(e,t),e}))},M=function(e){return fetch("https://gbfs.citibikenyc.com/gbfs/en/station_information.json").then((function(e){return e.json()})).then((function(t){return Object.assign(e,t),e}))};var S=Object(y.c)(_,Object(y.a)(L.a,(function(e){var t=e.dispatch;return function(e){return function(n){if(n.type===O){var s={},a={},i={};Promise.all([(c=s,void navigator.geolocation.getCurrentPosition((function(e){var t={lat:e.coords.latitude,lon:e.coords.longitude,isLocation:!0};return Object.assign(c,t),c}),(function(){return Object.assign(c,{lat:0,lon:0,isLocation:!1}),c}))),N(a),M(i)]).then((function(e){t({type:p,payload:{location:s,stations:a,info:i}})}))}var c;return e(n)}}})));r.a.render(Object(s.jsx)(b.a,{store:S,children:Object(s.jsx)(x,{})}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.46702868.chunk.js.map